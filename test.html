<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	<head>
		<title>用js下载excel</title>
		<style type="text/css" media="screen">
			body {background: #fff; width: 500px; margin: 20px auto;}
			label, input, textarea, h1, h2, p { font-family: Arial, sans-serif; font-size: 12pt;}
			input, textarea { border: solid 1px #aaa; padding: 4px; width: 98%;}
			label { font-weight: bold;}
			h1 { font-size: 30pt; font-weight: bold; letter-spacing: -1px;}
			h2 { font-size: 14pt;}
			pre { overflow: auto; padding: 10px; background: #222; color: #ccc;}
		</style>
		<script type="text/javascript" src="js/swfobject.js"></script>
		<script type="text/javascript" src="js/downloadify.min.js"></script>
	</head>
	<body onload="load();">
		<h1>Downloadify Example</h1>
		<p>More info available at the <a href="http://github.com/dcneiner/Downloadify">Github Project Page</a></p>
		<form>
			<p>
				<label for="data">File Contents</label><br />
   <table id='Table'>
   	<thead>
   		<tr>
   			<th>表体11</th>
   			<th>表体12</th>
   			<th>表体13</th>
   			<th>表体14</th>
   		</tr>
   	</thead>
   	<tbody>
   		<tr>
   			<td style="text-align: center;">内容1</td>
   			<td style="text-align: center;">内容2</td>
   			<td style="text-align: center;">内容3</td>
   			<td style="text-align: center;">内容4</td>
   		</tr>
   		<tr>
   			<td style="text-align: center;">内容1</td>
   			<td style="text-align: center;">内容2</td>
   			<td style="text-align: center;">内容3</td>
   			<td style="text-align: center;">内容4</td>
   		</tr>
   		<tr>
   			<td style="text-align: center;">内容1</td>
   			<td style="text-align: center;">内容2</td>
   			<td style="text-align: center;">内容3</td>
   			<td style="text-align: center;">内容4</td>
   		</tr>
   		<tr>
   			<td style="text-align: center;">内容1</td>
   			<td style="text-align: center;">内容2</td>
   			<td style="text-align: center;">内容3</td>
   			<td style="text-align: center;">内容4</td>
   		</tr>
   	</tbody>
   </table>
			</p>
			<p id="downloadify">
				You must have Flash 10 installed to download this file.
			</p>
		</form>

		<script type="text/javascript">
			function load(){
				Downloadify.create('downloadify',{
					filename: function(){
						return "Data.xls";
					},
					data: function(){ 
						var table = document.getElementById('Table');
		               var html = table.outerHTML;
		               return html;
					},
					onComplete: function(){ alert('Your File Has Been Saved!'); },
					onCancel: function(){ alert('You have cancelled the saving of this file.'); },
					onError: function(){ alert('You must put something in the File Contents or there will be nothing to save!'); },
					swf: 'media/downloadify.swf',
					downloadImage: 'images/download.png',
					width: 100,
					height: 30,
					transparent: true,
					append: false
				});
			}
		</script>
	</body>
</html>
